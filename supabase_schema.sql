-- ==============================================================================
-- SCHEMA SUPABASE - MANU3D (V2.1 - Mise à jour Atelier Request)
-- ==============================================================================

-- ... (LES TABLES PRECEDENTES RESTENT INCHANGEES) ...
-- Gardez les tables site_config, creators, products, printing_materials, coupons, shipping_methods, orders, partners, reviews, portfolio

-- 11. DEMANDES DE PROJET (NOUVEAU - Remplace le configurateur auto)
create table if not exists project_requests (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()),
  customer_name text not null,
  customer_email text not null,
  project_type text, -- 'Figurine', 'Cosplay', 'Technique', 'Autre'
  description text,
  file_url text, -- Lien vers le fichier stocké (ou nom du fichier)
  status text default 'new', -- 'new', 'read', 'quoted', 'archived'
  is_urgent boolean default false
);

-- RLS pour project_requests
alter table project_requests enable row level security;
create policy "Public insert requests" on project_requests for insert with check (true);
-- Seul l'admin peut lire (via dashboard supabase)
